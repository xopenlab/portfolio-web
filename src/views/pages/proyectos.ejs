<!DOCTYPE html>
<html lang="es" data-color-themes='<%- JSON.stringify(colorThemes) %>' data-default-theme="<%= defaultTheme %>">
<head>
  <%- include('../partials/head', { title }) %>
</head>
<body class="<%= pageState %> antialiased" x-data x-cloak>
  <!-- Header/Navigation -->
  <%- include('../partials/header', { pageState }) %>

  <!-- Navegación interna -->
  <%- include('../partials/components/internal-nav') %>

  <!-- Page Transition Wrapper -->
  <div class="page-transition-wrapper">
    <!-- Main Content -->
    <main class="proyectos-container" x-data="{ panel: null }" @keydown.escape.window="panel = null">
      <!-- Fondo Vanta.js -->
      <div class="vanta-bg" id="vanta-proyectos"></div>

      <!-- Texto introductorio -->
      <section class="proyectos-about animate-fade-in-up">
        <p class="proyectos-text">
          Una selección de proyectos profesionales en los que he participado, desde aplicaciones web completas hasta APIs RESTful y soluciones de automatización industrial.
        </p>
      </section>

      <!-- Indicador pulsante izquierdo: Aplicaciones Web -->
      <button class="proyectos-trigger proyectos-trigger--left animate-fade-in reveal-delay-1"
        :class="{ 'is-active': panel === 'webapp' }"
        @click="panel = panel === 'webapp' ? null : 'webapp'"
        aria-label="Ver aplicaciones web">
        <span class="proyectos-trigger-dot"></span>
        <span class="proyectos-trigger-label">Aplicaciones Web</span>
      </button>

      <!-- Indicador pulsante derecho superior: APIs y Servicios -->
      <button class="proyectos-trigger proyectos-trigger--right proyectos-trigger--right-top animate-fade-in reveal-delay-1"
        :class="{ 'is-active': panel === 'api' }"
        @click="panel = panel === 'api' ? null : 'api'"
        aria-label="Ver APIs y servicios">
        <span class="proyectos-trigger-label">APIs y Servicios</span>
        <span class="proyectos-trigger-dot"></span>
      </button>

      <!-- Indicador pulsante derecho inferior: Automatización -->
      <button class="proyectos-trigger proyectos-trigger--right proyectos-trigger--right-bottom animate-fade-in reveal-delay-2"
        :class="{ 'is-active': panel === 'automation' }"
        @click="panel = panel === 'automation' ? null : 'automation'"
        aria-label="Ver automatización">
        <span class="proyectos-trigger-label">Automatización</span>
        <span class="proyectos-trigger-dot"></span>
      </button>

      <!-- Bordes decorativos -->
      <%- include('../partials/components/decorative-borders') %>

      <!-- Overlay -->
      <div class="proyectos-overlay"
        x-show="panel !== null"
        x-transition:enter="transition ease-out duration-300"
        x-transition:enter-start="opacity-0"
        x-transition:enter-end="opacity-100"
        x-transition:leave="transition ease-in duration-200"
        x-transition:leave-start="opacity-100"
        x-transition:leave-end="opacity-0"
        @click="panel = null"
        style="display: none;">
      </div>

      <!-- Panel izquierdo: Aplicaciones Web -->
      <div class="proyectos-panel proyectos-panel--left"
        :class="{ 'is-open': panel === 'webapp' }">
        <button class="proyectos-panel-close" @click="panel = null" aria-label="Cerrar panel">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <path d="M18 6L6 18M6 6l12 12"/>
          </svg>
        </button>
        <h2 class="proyectos-section-title">Aplicaciones Web</h2>
        <div class="proyectos-timeline">
          <% data.projects.featured.filter(p => p.category === 'webapp').forEach(function(proj) { %>
            <div class="proyectos-item">
              <div class="proyectos-item-content">
                <span class="proyectos-project-title"><%= proj.title %></span>
                <span class="proyectos-company"><%= proj.company %></span>
              </div>
            </div>
          <% }); %>
        </div>
      </div>

      <!-- Panel derecho: APIs y Servicios -->
      <div class="proyectos-panel proyectos-panel--right"
        :class="{ 'is-open': panel === 'api' }">
        <button class="proyectos-panel-close" @click="panel = null" aria-label="Cerrar panel">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <path d="M18 6L6 18M6 6l12 12"/>
          </svg>
        </button>
        <h2 class="proyectos-section-title">APIs y Servicios</h2>
        <div class="proyectos-timeline">
          <% data.projects.featured.filter(p => p.category === 'api').forEach(function(proj) { %>
            <div class="proyectos-item">
              <div class="proyectos-item-content">
                <span class="proyectos-project-title"><%= proj.title %></span>
                <span class="proyectos-company"><%= proj.company %></span>
              </div>
            </div>
          <% }); %>
        </div>
      </div>

      <!-- Panel derecho: Automatización -->
      <div class="proyectos-panel proyectos-panel--right"
        :class="{ 'is-open': panel === 'automation' }">
        <button class="proyectos-panel-close" @click="panel = null" aria-label="Cerrar panel">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <path d="M18 6L6 18M6 6l12 12"/>
          </svg>
        </button>
        <h2 class="proyectos-section-title">Automatización</h2>
        <div class="proyectos-timeline">
          <% data.projects.featured.filter(p => p.category === 'automation').forEach(function(proj) { %>
            <div class="proyectos-item">
              <div class="proyectos-item-content">
                <span class="proyectos-project-title"><%= proj.title %></span>
                <span class="proyectos-company"><%= proj.company %></span>
              </div>
            </div>
          <% }); %>
        </div>
      </div>
    </main>
  </div>

  <!-- Footer -->
  <%- include('../partials/footer') %>

  <!-- Banner de Cookies -->
  <%- include('../partials/cookie-banner') %>

  <!-- Cortina de transición entre páginas -->
  <%- include('../partials/components/page-curtain') %>

  <!-- Scripts: Los stores deben cargarse ANTES de Alpine.js -->
  <script src="/js/alpine-setup.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.15.1/dist/cdn.min.js"></script>
  <script type="module" src="/js/main.js"></script>

  <!-- Vanta.js Halo (solo proyectos) -->
  <script src="/vendor/three/three.min.js"></script>
  <script src="/vendor/vanta/vanta.halo.min.js"></script>
  <script src="/js/vanta-halo.js"></script>
</body>
</html>
