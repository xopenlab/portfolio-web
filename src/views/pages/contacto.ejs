<!DOCTYPE html>
<html lang="es" data-color-themes='<%- JSON.stringify(colorThemes) %>' data-default-theme="<%= defaultTheme %>">
<head>
  <%- include('../partials/head', { title }) %>
  <link rel="stylesheet" href="/vendor/leaflet/leaflet.css">
</head>
<body class="<%= pageState %> antialiased" x-data x-cloak>
  <!-- Header/Navigation -->
  <%- include('../partials/header', { pageState }) %>

  <!-- Page Transition Wrapper -->
  <div class="page-transition-wrapper">
    <!-- Navegación interna -->
    <%- include('../partials/components/internal-nav') %>
    <!-- Main Content -->
    <main class="contacto-container">
      <!-- Fondo anime.js -->
      <div class="anime-bg" id="anime-contacto">
        <div class="anime-creature" id="anime-creature"></div>
      </div>

      <!-- Mapa Leaflet -->
      <div class="contacto-map-wrapper animate-fade-in-up">
        <div id="contacto-map"></div>
      </div>

      <!-- Indicador pulsante derecho: Contacto -->
      <button class="contacto-trigger animate-fade-in reveal-delay-1"
        :class="{ 'is-active': $store.panel.current === 'contacto' }"
        @click="$store.panel.toggle('contacto')"
        aria-label="Ver datos de contacto">
        <span class="contacto-trigger-label">Contacto</span>
        <span class="contacto-trigger-dot"></span>
      </button>

      <!-- Bordes decorativos -->
      <%- include('../partials/components/decorative-borders') %>

      <!-- Overlay -->
      <div class="contacto-overlay"
        x-show="$store.panel.current !== null"
        x-transition:enter="transition ease-out duration-300"
        x-transition:enter-start="opacity-0"
        x-transition:enter-end="opacity-100"
        x-transition:leave="transition ease-in duration-200"
        x-transition:leave-start="opacity-100"
        x-transition:leave-end="opacity-0"
        @click="$store.panel.close()"
        style="display: none;">
      </div>

      <!-- Panel derecho: Contacto -->
      <div class="contacto-panel"
        :class="{ 'is-open': $store.panel.current === 'contacto' }">
        <button class="contacto-panel-close" @click="$store.panel.close()" aria-label="Cerrar panel">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <path d="M18 6L6 18M6 6l12 12"/>
          </svg>
        </button>
        <h2 class="contacto-section-title">Contacto</h2>
        <div class="contacto-item">
          <span class="contacto-item-label">Ubicación</span>
          <span class="contacto-item-value">Almussafes (Valencia) cp. 46440</span>
        </div>
        <div class="contacto-item">
          <span class="contacto-item-label">Teléfono</span>
          <a href="tel:+34667701362" class="contacto-item-value">+34 667 70 13 62</a>
        </div>
        <div class="contacto-item">
          <span class="contacto-item-label">Email</span>
          <a href="mailto:jperegir@gmail.com" class="contacto-item-value">jperegir@gmail.com</a>
        </div>
      </div>
    </main>
  </div>

  <!-- Footer -->
  <%- include('../partials/footer') %>

  <!-- Banner de Cookies -->
  <%- include('../partials/cookie-banner') %>

  <!-- Cortina de transición entre páginas -->
  <%- include('../partials/components/page-curtain') %>

  <!-- Scripts: Los stores deben cargarse ANTES de Alpine.js -->
  <script src="/js/alpine-setup.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.15.1/dist/cdn.min.js"></script>
  <script type="module" src="/js/main.js"></script>

  <!-- Leaflet + Mapa de contacto -->
  <script src="/vendor/leaflet/leaflet.js"></script>
  <script src="/js/contacto-map.js"></script>

  <!-- Anime.js - Fondo animado -->
  <script src="/vendor/animejs/anime.umd.min.js"></script>
  <script src="/js/anime-creature.js"></script>
</body>
</html>
